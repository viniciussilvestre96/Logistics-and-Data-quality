import pandas as pd
import numpy as np

# Dataset loading
df = pd.read_csv('seu_arquivo.csv')

# --- STEP 1: To remove empty strings and null values, initially we do a conversion ---
df[['Timestamp', 'Vehicle_GPS_Latitude', 'Vehicle_GPS_Longitude']] = \
    df[['Timestamp', 'Vehicle_GPS_Latitude', 'Vehicle_GPS_Longitude']].replace('', np.nan)

# Remove from dataframe all items that are null 
df = df.dropna(subset=['Timestamp', 'Vehicle_GPS_Latitude', 'Vehicle_GPS_Longitude'])

# --- STEP 2: Remove the duplicates that look obvious ---
df = df.drop_duplicates()

# --- STEP 3: Adjusting Scales ---
df['Traffic_Congestion_Level'] = df['Traffic_Congestion_Level'].clip(lower=0, upper=10)

# Command line to guarantee that fuel consumption isn't a negative value
df['Fuel_Consumption_Rate'] = df['Fuel_Consumption_Rate'].clip(lower=0)

# --- STEP 4: To filter invalid coordinates ---

valid_lat = df['Vehicle_GPS_Latitude'].between(-90, 90)
valid_lon = df['Vehicle_GPS_Longitude'].between(-180, 180)
not_zero_island = ~((df['Vehicle_GPS_Latitude'] == 0) & (df['Vehicle_GPS_Longitude'] == 0))


df_limpo = df[valid_lat & valid_lon & not_zero_island].copy()

#Final Result
print(f"Dados originais: {len(df)}")
print(f"Dados ap√≥s limpeza: {len(df_limpo)}")
